# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|
  # ğŸ’¡ ARM64 ì•„í‚¤í…ì²˜ë¥¼ ì§€ì›í•˜ëŠ” Ubuntu ê¸°ë°˜ Boxë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
  # (ì˜ˆ: perk/ubuntu-2204-arm64, generic/ubuntu2004 ë“±)
  # config.vm.box = "perk/ubuntu-2204-arm64"
  config.vm.box = "cloud-image/ubuntu-24.04"

 
  # VMì˜ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ì„¤ì •í•©ë‹ˆë‹¤.
  config.vm.hostname = "ubuntu-m1-vm"

  # QEMU í”„ë¡œë°”ì´ë” ì„¤ì •
  config.vm.provider "qemu" do |qe|
    # í• ë‹¹í•  ë©”ëª¨ë¦¬ì™€ CPU ì½”ì–´ ìˆ˜ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. (ì„ íƒ ì‚¬í•­)
    qe.memory = 4096 
    qe.cpus = 2
    
    # QEMU ì•„í‚¤í…ì²˜ë¥¼ ARM64ë¡œ ì„¤ì • (M1/M2 ì¹©ì˜ ê¸°ë³¸ ì•„í‚¤í…ì²˜)
    qe.arch = "aarch64" 

    # HVF(Hypervisor Framework)ë¥¼ ì‚¬ìš©í•˜ì—¬ ë„¤ì´í‹°ë¸Œ ì„±ëŠ¥ì„ í™œìš©
    # qe.machine = "virt,accel=hvf" 
    # virt,accel=hvfëŠ” vagrant-qemuì˜ ê¸°ë³¸ê°’ì¼ ê°€ëŠ¥ì„±ì´ ë†’ìœ¼ë¯€ë¡œ ëª…ì‹œí•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.
    
    # ì¶”ê°€ QEMU ì¸ìë¥¼ ì „ë‹¬í•´ì•¼ í•  ê²½ìš° ì‚¬ìš© (ì¼ë°˜ì ìœ¼ë¡œ í•„ìš”í•˜ì§€ ì•ŠìŒ)
    # qe.extra_qemu_args = %w(-display none)
  end

  config.vm.synced_folder ".", "/vagrant", type: "rsync"

  # ë„¤íŠ¸ì›Œí¬ ì„¤ì • (ì„ íƒ ì‚¬í•­)
  # í¬íŠ¸ í¬ì›Œë”© ì˜ˆì‹œ: í˜¸ìŠ¤íŠ¸ 8080 í¬íŠ¸ë¥¼ VMì˜ 80 í¬íŠ¸ë¡œ ì—°ê²°
  config.vm.network "forwarded_port", guest: 80, host: 8082

  # í”„ë¡œë¹„ì €ë‹ (ì„ íƒ ì‚¬í•­)
  # VM ë¶€íŒ… í›„ ì‹¤í–‰í•  ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì§€ì •
  # config.vm.provision "shell", inline: <<-SHELL
  #   sudo apt-get update
  #   sudo apt-get install -y git 
  # SHELL
end
